function prechargement(){Plotly.setPlotConfig({locale:"fr"});Plotly.newPlot(document.getElementById("karasek"),[{x:[28,19,19,36,36,36,36,36,36,36,36,36,36,28,28,36,28,28,28,28,28,28,36,28,28,36,28,28,19,19,19,19,19,19,19,19,28,28,36,28,28,36,28,28,19,28,28,28,28,28,36,28,28,28,28,19,28,28,28,28],y:[0,0,0,0,0,9,9,18,18,27,27,0,0,0,9,9,9,0,9,9,0,9,9,9,18,18,18,9,9,0,9,9,18,18,0,18,18,27,27,27,27,27,27,18,18,18,18,18,18,18,18,18,9,9,9,9,9,9,0,0],z:[19,19,36,36,10,10,19,19,28,28,36,36,10,10,10,10,10,
    10,10,19,19,19,19,19,19,19,19,19,19,19,19,28,28,36,36,36,36,36,36,36,28,28,28,28,28,28,19,28,36,28,28,28,28,19,28,28,28,10,10,19],type:"scatter3d",mode:"lines",line:{color:"green",width:2},hoverinfo:"none",name:"Travail Protecteur"},{x:[9,9,9,9,9,9,9,18,18,9,18,18,9,18,18,18,18,0,18,18,9,9,9,0,9,9,0,9,9,0,9,9,0,9,9,0,9,9,9,9,0,0,0,0,0,0,0,0,0,9,0,0,0,0,9,9,9,0,9,9,9,9,9,9,18,18,9,9,9,18,18],y:[36,19,28,28,28,19,28,28,28,28,28,36,36,36,36,19,36,36,36,36,36,36,28,28,28,28,28,28,19,19,19,19,19,19,10,
    10,10,10,0,10,10,0,10,10,19,19,28,28,36,36,36,36,0,0,0,0,0,0,0,19,19,10,19,19,19,19,19,19,19,19,28],z:[18,18,18,27,9,9,9,9,18,18,18,18,18,18,0,0,0,0,0,18,18,36,36,36,36,27,27,27,27,27,27,18,18,18,18,18,18,9,9,9,9,9,9,18,18,27,27,36,36,36,36,0,0,9,9,0,0,0,0,0,9,9,9,0,0,9,9,18,9,9,9],type:"scatter3d",mode:"lines",line:{color:"red",width:2},hoverinfo:"none",name:"Risque pour la Sant\u00e9"}],{autosize:!0,dragmode:"turntable",showlegend:!0,legend:{x:0,y:0},scene:{xaxis:{range:[0,36],title:"Soutien",tickmode:"linear",
    dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},yaxis:{range:[0,36],title:"Exigences",tickmode:"linear",dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},zaxis:{range:[0,36],title:"Autonomie",tickmode:"linear",dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},camera:{up:{y:0,x:0,z:1},center:{y:0,x:0,z:-.5},eye:{y:2.5,x:1.5,z:1}}},margin:{l:0,r:0,b:0,t:0,pad:1}},{modeBarButtonsToRemove:["toImage","sendDataToCloud","resetCameraDefault3d","resetCameraLastSave3d",
    "hoverClosest3d"],displayModeBar:!0,displaylogo:!1,responsive:!0});Plotly.newPlot(document.getElementById("siegrist"),[{x:[28,19,19,36,36,36,36,36,36,36,36,36,36,28,28,36,28,28,28,28,28,28,36,28,28,36,28,28,19,19,19,19,19,19,19,19,28,28,36,28,28,36,28,28,19,28,28,28,28,28,36,28,28,28,28,19,28,28,28,28],y:[0,0,0,0,0,9,9,18,18,27,27,0,0,0,9,9,9,0,9,9,0,9,9,9,18,18,18,9,9,0,9,9,18,18,0,18,18,27,27,27,27,27,27,18,18,18,18,18,18,18,18,18,9,9,9,9,9,9,0,0],z:[19,19,36,36,10,10,19,19,28,28,36,36,10,10,10,
    10,10,10,10,19,19,19,19,19,19,19,19,19,19,19,19,28,28,36,36,36,36,36,36,36,28,28,28,28,28,28,19,28,36,28,28,28,28,19,28,28,28,10,10,19],type:"scatter3d",mode:"lines",line:{color:"green",width:2},hoverinfo:"none",name:"Travail Protecteur"},{x:[9,9,9,9,9,9,9,18,18,9,18,18,9,18,18,18,18,0,18,18,9,9,9,0,9,9,0,9,9,0,9,9,0,9,9,0,9,9,9,9,0,0,0,0,0,0,0,0,0,9,0,0,0,0,9,9,9,0,9,9,9,9,9,9,18,18,9,9,9,18,18],y:[36,19,28,28,28,19,28,28,28,28,28,36,36,36,36,19,36,36,36,36,36,36,28,28,28,28,28,28,19,19,19,19,19,
    19,10,10,10,10,0,10,10,0,10,10,19,19,28,28,36,36,36,36,0,0,0,0,0,0,0,19,19,10,19,19,19,19,19,19,19,19,28],z:[18,18,18,27,9,9,9,9,18,18,18,18,18,18,0,0,0,0,0,18,18,36,36,36,36,27,27,27,27,27,27,18,18,18,18,18,18,9,9,9,9,9,9,18,18,27,27,36,36,36,36,0,0,9,9,0,0,0,0,0,9,9,9,0,0,9,9,18,9,9,9],type:"scatter3d",mode:"lines",line:{color:"red",width:2},hoverinfo:"none",name:"Risque pour la Sant\u00e9"}],{autosize:!0,dragmode:"turntable",showlegend:!0,legend:{x:0,y:0},scene:{xaxis:{range:[0,36],title:"Reconnaissance",
    tickmode:"linear",dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},yaxis:{range:[0,36],title:"Exigences",tickmode:"linear",dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},zaxis:{range:[0,36],title:"Autonomie",tickmode:"linear",dtick:9,mirror:!0,nticks:9,type:"linear",autorange:!1,showline:!0},camera:{up:{y:0,x:0,z:1},center:{y:0,x:0,z:-.5},eye:{y:2.5,x:1.5,z:1}}},margin:{l:0,r:0,b:0,t:0,pad:1}},{modeBarButtonsToRemove:["toImage","sendDataToCloud","resetCameraDefault3d",
    "resetCameraLastSave3d","hoverClosest3d"],displayModeBar:!0,displaylogo:!1,responsive:!0})}
    function saveTextAsFile(){for(var a="",b=document.getElementById("commentairesExigences").value,e=document.getElementById("commentairesAutonomie").value,g=document.getElementById("commentairesSoutien").value,f=document.getElementById("commentairesReconnaissance").value,h=1;13>h;h++){for(var n=document.getElementsByName("A"+h),d=0;4>d;d++)if(n[d].checked)switch(d){case 0:a+="pas d'accord";break;case 1:a+="plut\u00f4t pas d'accord";break;case 2:a+="plut\u00f4t d'accord";break;case 3:a+="d'accord";break;
    default:a+=""}a+=","}a+=b.replace(/\n/g,"/").replace(/\r/g,"/").replace(/,/g,";");a+="\n";for(h=1;13>h;h++){b=document.getElementsByName("B"+h);for(d=0;4>d;d++)if(b[d].checked)switch(d){case 0:a+="pas d'accord";break;case 1:a+="plut\u00f4t pas d'accord";break;case 2:a+="plut\u00f4t d'accord";break;case 3:a+="d'accord";break;default:a+=""}a+=","}a+=e.replace(/\n/g,"/").replace(/\r/g,"/").replace(/,/g,";");a+="\n";for(h=1;13>h;h++){e=document.getElementsByName("C"+h);for(d=0;4>d;d++)if(e[d].checked)switch(d){case 0:a+=
    "pas d'accord";break;case 1:a+="plut\u00f4t pas d'accord";break;case 2:a+="plut\u00f4t d'accord";break;case 3:a+="d'accord";break;default:a+=""}a+=","}a+=g.replace(/\n/g,"/").replace(/\r/g,"/").replace(/,/g,";");a+="\n";for(h=1;13>h;h++){g=document.getElementsByName("D"+h);for(d=0;4>d;d++)if(g[d].checked)switch(d){case 0:a+="pas d'accord";break;case 1:a+="plut\u00f4t pas d'accord";break;case 2:a+="plut\u00f4t d'accord";break;case 3:a+="d'accord";break;default:a+=""}a+=","}a+=f.replace(/\n/g,"/").replace(/\r/g,
    "/").replace(/,/g,";");a=new Blob([a],{type:"text/plain"});a=window.URL.createObjectURL(a);f="questionnaireQVT_"+Date.now()+".csv";h=document.createElement("a");h.download=f;h.innerHTML="T&eacute;l&eacute;charger le fichier "+f;h.href=a;h.onclick=destroyClickedElement;h.style.display="none";document.body.appendChild(h);h.click()}function destroyClickedElement(a){document.body.removeChild(a.target)}
    function sauveimages(){var a=Date.now(),b="graphiqueQVT-K_"+a;a="graphiqueQVT-S_"+a;Plotly.downloadImage(document.getElementById("karasek"),{format:"png",width:800,height:800,filename:b});Plotly.downloadImage(document.getElementById("siegrist"),{format:"png",width:800,height:800,filename:a})}
    function positionpoint(a,b,e){var g,f;0<=b&&9>=b&&(g=1);10<=b&&18>=b&&(g=10);19<=b&&27>=b&&(g=100);28<=b&&36>=b&&(g=1E3);0<=e&&9>=e&&(f=1E3);10<=e&&18>=e&&(f=100);19<=e&&27>=e&&(f=10);28<=e&&36>=e&&(f=1);b=f+g;if(2===b||11===b){if(28<=a&&36>=a||19<=a&&27>=a)return 1;if(10<=a&&18>=a)return 2;if(0<=a&&9>=a)return 3}if(20===b||101===b){if(28<=a&&36>=a)return 1;if(19<=a&&27>=a)return 2;if(10<=a&&18>=a||0<=a&&9>=a)return 3}if(1001===b||110===b||1010===b||200===b){if(28<=a&&36>=a)return 2;if(10<=a&&18>=
    a||19<=a&&27>=a)return 3;if(0<=a&&9>=a)return 4}if(1100===b||2E3===b){if(28<=a&&36>=a||19<=a&&27>=a)return 3;if(10<=a&&18>=a||0<=a&&9>=a)return 4}return 0}
    function graphiques(a,b,e,g,f,h,n,d,c){if(void 0===document.getElementById("karasek").data||void 0===document.getElementById("siegrist").data)document.getElementById("Messages").innerHTML+="<br/>Initialisation de l'environnement graphique...",prechargement();a={x:[a],y:[e],z:[g],type:"scatter3d",hoverinfo:"x+y+z+text",text:h,hoverlabel:{bgcolor:d},marker:{color:d}};b={x:[b],y:[e],z:[g],type:"scatter3d",hoverinfo:"x+y+z+text",text:n,hoverlabel:{bgcolor:c},marker:{color:c}};e={showlegend:!1};g={showlegend:!0};
    Plotly.addTraces(document.getElementById("karasek"),a);Plotly.addTraces(document.getElementById("siegrist"),b);Plotly.restyle(document.getElementById("karasek"),e);Plotly.restyle(document.getElementById("karasek"),g,[0,1]);Plotly.restyle(document.getElementById("siegrist"),e);Plotly.restyle(document.getElementById("siegrist"),g,[0,1]);if(!0===f)document.getElementById("siegrist").on("plotly_afterplot",function(){document.getElementById("filesToLoad").value=""});changeclass("boutonQ",!0);changeclass("boutonG",
    !1);800>screen.width?document.getElementById("cubes").style.display="block":document.getElementById("cubes").style.display="grid"}function purge(){2<document.getElementById("karasek").data.length&&2<document.getElementById("siegrist").data.length&&(Plotly.deleteTraces(document.getElementById("karasek"),-1),Plotly.deleteTraces(document.getElementById("siegrist"),-1))}
    function purgetotale(){void 0!=document.getElementById("karasek").data&&void 0!=document.getElementById("siegrist").data&&2<document.getElementById("karasek").data.length&&2<document.getElementById("siegrist").data.length&&(Plotly.purge(document.getElementById("karasek")),Plotly.purge(document.getElementById("siegrist")),prechargement(),document.getElementById("cubes").style.display="grid")}
    function effacer(){for(var a=1;13>a;a++)for(var b=document.getElementsByName("A"+a),e=document.getElementsByName("B"+a),g=document.getElementsByName("C"+a),f=document.getElementsByName("D"+a),h=0;4>h;h++)b[h].checked=!1,e[h].checked=!1,g[h].checked=!1,f[h].checked=!1;document.getElementById("commentairesExigences").value="";document.getElementById("commentairesAutonomie").value="";document.getElementById("commentairesSoutien").value="";document.getElementById("commentairesReconnaissance").value="";
    document.getElementById("autonomie").value="";document.getElementById("exigences").value="";document.getElementById("soutien").value="";document.getElementById("reconnaissance").value="";window.scrollTo(0,0)}
    function traiter(){for(var a=!1,b=!1,e=!1,g=!1,f=[],h=[],n=[],d=[],c=1;13>c;c++){for(var m=document.getElementsByName("A"+c),p=document.getElementsByName("B"+c),q=document.getElementsByName("C"+c),r=document.getElementsByName("D"+c),k=0;4>k;k++)m[k].checked&&(exigences+=parseInt(m[k].value),a=!0),p[k].checked&&(autonomie+=parseInt(p[k].value),b=!0),q[k].checked&&(soutien+=parseInt(q[k].value),e=!0),r[k].checked&&(reconnaissance+=parseInt(r[k].value),g=!0);if(!1===a){f[c-1]="A"+c;break}!1===b&&(h[c-
    1]="B"+c);!1===e&&(n[c-1]="C"+c);!1===g&&(d[c-1]="D"+c);g=e=b=a=!1}if(0<f.length)a=f.findIndex(function(a){return null!=a}),window.alert("Questionnaire incomplet : question "+(a+1)+" de la partie Exigences"),0===a?window.scrollTo(0,0):document.getElementById("A"+a+"3").scrollIntoView(!0);else if(0<h.length)a=h.findIndex(function(a){return null!=a}),window.alert("Questionnaire incomplet : question "+(a+1)+" de la partie Autonomie"),0===a?(document.getElementById("B123").scrollIntoView(!0),document.getElementById("A123").scrollIntoView(!0)):
    (document.getElementById("B123").scrollIntoView(!0),document.getElementById("B"+a+"3").scrollIntoView(!0));else if(0<n.length)a=n.findIndex(function(a){return null!=a}),window.alert("Questionnaire incomplet : question "+(a+1)+" de la partie Soutien"),0===a?(document.getElementById("C123").scrollIntoView(!0),document.getElementById("B123").scrollIntoView(!0)):(document.getElementById("C123").scrollIntoView(!0),document.getElementById("C"+a+"3").scrollIntoView(!0));else if(0<d.length)a=d.findIndex(function(a){return null!=
    a}),window.alert("Questionnaire incomplet : question "+(a+1)+" de la partie Reconnaissance"),0===a?(document.getElementById("D123").scrollIntoView(!0),document.getElementById("C123").scrollIntoView(!0)):(document.getElementById("D123").scrollIntoView(!0),document.getElementById("D"+a+"3").scrollIntoView(!0));else{calculer();a=positionpoint(document.getElementById("soutien").value,document.getElementById("exigences").value,document.getElementById("autonomie").value);e=positionpoint(document.getElementById("reconnaissance").value,
    document.getElementById("exigences").value,document.getElementById("autonomie").value);switch(a){case 1:a="Le point est dans la zone de travail protecteur :)";b="darkgreen";break;case 2:a="Le point est dans la zone d'attention.";b="yellow";break;case 3:a="Le point est dans la zone d'alerte !";b="darkorange";break;case 4:a="Le point est dans la zone de risque pour la sant\u00e9 :(";b="red";break;default:a="",b="darkgrey"}switch(e){case 1:e="Le point est dans la zone de travail protecteur :)";g="darkgreen";
    break;case 2:e="Le point est dans la zone d'attention.";g="yellow";break;case 3:e="Le point est dans la zone d'alerte !";g="darkorange";break;case 4:e="Le point est dans la zone de risque pour la sant\u00e9 :(";g="red";break;default:e="",g="darkgrey"}a+="<br/>questionnaire saisi directement";e+="<br/>questionnaire saisi directement";purgetotale();graphiques(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value,
    !1,a,e,b,g);recommandations(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value)}}
    function loadMultipleFilesAsText(a){!0===a&&(fileToLoad=document.getElementById("filesToLoad").files);!1===a&&(fileToLoad=document.getElementById("fileToLoad").files);if(0<fileToLoad.length){1===fileToLoad.length?document.getElementById("Messages").innerHTML+="<br/>Chargement de : "+fileToLoad[0].name:document.getElementById("Messages").innerHTML+="<br/>Chargement de "+fileToLoad.length+" fichiers.";document.getElementById("Messages").style.display="inline";for(var b=compteur=0;b<fileToLoad.length;b++)if(0<
    fileToLoad[b].size&&"questionnaireQVT_"===fileToLoad[b].name.slice(0,17)&&".csv"===fileToLoad[b].name.slice(-4)){var e=new FileReader;e.readAsText(fileToLoad[b],"UTF-8");e.onload=function(g){var f=[],e=g.target.result.split("\n");g=e[0].split(",");var b=e[1].split(","),d=e[2].split(",");e=e[3].split(",");for(var c=0;12>c;c++)if("pas d'accord"!==g[c]&&"plut\u00f4t pas d'accord"!==g[c]&&"plut\u00f4t d'accord"!==g[c]&&"d'accord"!==g[c]){f[c]="A"+(c+1);document.getElementById("Messages").innerHTML+="<br/>"+
    fileToLoad[compteur].name+" : incomplet, question A"+(c+1);break}else"pas d'accord"!==b[c]&&"plut\u00f4t pas d'accord"!==b[c]&&"plut\u00f4t d'accord"!==b[c]&&"d'accord"!==b[c]?(f[c]="B"+(c+1),document.getElementById("Messages").innerHTML+="<br/>"+fileToLoad[compteur].name+" : incomplet, question B"+(c+1)):"pas d'accord"!==d[c]&&"plut\u00f4t pas d'accord"!==d[c]&&"plut\u00f4t d'accord"!==d[c]&&"d'accord"!==d[c]?(f[c]="C"+(c+1),document.getElementById("Messages").innerHTML+="<br/>"+fileToLoad[compteur].name+
    " : incomplet, question C"+(c+1)):"pas d'accord"!==e[c]&&"plut\u00f4t pas d'accord"!==e[c]&&"plut\u00f4t d'accord"!==e[c]&&"d'accord"!==e[c]?(f[c]="D"+(c+1),document.getElementById("Messages").innerHTML+="<br/>"+fileToLoad[compteur].name+" : incomplet, question D"+(c+1)):f[c]="OK";var m=f.findIndex(function(a){return"OK"!=a});if(-1===m||1===fileToLoad.length){effacer();document.getElementById("commentairesExigences").value=g[12].replace(/\//g,"\n").replace(/;/g,",");document.getElementById("commentairesAutonomie").value=
    b[12].replace(/\//g,"\n").replace(/;/g,",");document.getElementById("commentairesSoutien").value=d[12].replace(/\//g,"\n").replace(/;/g,",");document.getElementById("commentairesReconnaissance").value=e[12].replace(/\//g,"\n").replace(/;/g,",");for(c=0;12>c;c++){var p=c+1,q=document.getElementsByName("A"+p),r=document.getElementsByName("B"+p),k=document.getElementsByName("C"+p);p=document.getElementsByName("D"+p);switch(g[c]){case "pas d'accord":q[0].checked=!0;break;case "plut\u00f4t pas d'accord":q[1].checked=
    !0;break;case "plut\u00f4t d'accord":q[2].checked=!0;break;case "d'accord":q[3].checked=!0}switch(b[c]){case "pas d'accord":r[0].checked=!0;break;case "plut\u00f4t pas d'accord":r[1].checked=!0;break;case "plut\u00f4t d'accord":r[2].checked=!0;break;case "d'accord":r[3].checked=!0}switch(d[c]){case "pas d'accord":k[0].checked=!0;break;case "plut\u00f4t pas d'accord":k[1].checked=!0;break;case "plut\u00f4t d'accord":k[2].checked=!0;break;case "d'accord":k[3].checked=!0}switch(e[c]){case "pas d'accord":p[0].checked=
    !0;break;case "plut\u00f4t pas d'accord":p[1].checked=!0;break;case "plut\u00f4t d'accord":p[2].checked=!0;break;case "d'accord":p[3].checked=!0}}if(-1===m){calculer();f=positionpoint(document.getElementById("soutien").value,document.getElementById("exigences").value,document.getElementById("autonomie").value);b=positionpoint(document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value);switch(f){case 1:f="Le point est dans la zone de travail protecteur :)";
    g="darkgreen";break;case 2:f="Le point est dans la zone d'attention.";g="yellow";break;case 3:f="Le point est dans la zone d'alerte !";g="darkorange";break;case 4:f="Le point est dans la zone de risque pour la sant\u00e9 :(";g="red";break;default:f="",g="darkgrey"}switch(b){case 1:b="Le point est dans la zone de travail protecteur :)";d="darkgreen";break;case 2:b="Le point est dans la zone d'attention.";d="yellow";break;case 3:b="Le point est dans la zone d'alerte !";d="darkorange";break;case 4:b=
    "Le point est dans la zone de risque pour la sant\u00e9 :(";d="red";break;default:b="",d="darkgrey"}f+="<br>"+fileToLoad[compteur].name;b+="<br>"+fileToLoad[compteur].name;1===fileToLoad.length?!1===a?(purgetotale(),graphiques(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value,!1,f,b,g,d),recommandations(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,
    document.getElementById("exigences").value,document.getElementById("autonomie").value),document.getElementById("Questionnaire").style.display="inline",document.getElementById("Recommandations").scrollIntoView(!0)):!0===a&&graphiques(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value,!1,f,b,g,d):compteur<fileToLoad.length-1?(graphiques(document.getElementById("soutien").value,
    document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value,!1,f,b,g,d),effacer()):compteur===fileToLoad.length-1&&(graphiques(document.getElementById("soutien").value,document.getElementById("reconnaissance").value,document.getElementById("exigences").value,document.getElementById("autonomie").value,!0,f,b,g,d),effacer())}else{f.sort();if(1===parseInt(f[0].substr(1)))switch(f[0].charAt(1)){case "A":window.scrollTo(0,0);break;
    case "B":document.getElementById("B123").scrollIntoView(!0);document.getElementById("A123").scrollIntoView(!0);break;case "C":document.getElementById("C123").scrollIntoView(!0);document.getElementById("B123").scrollIntoView(!0);break;case "D":document.getElementById("D123").scrollIntoView(!0),document.getElementById("C123").scrollIntoView(!0)}else switch(f[0].charAt(1)){case "A":document.getElementById("A"+(parseInt(f[0].substr(1))-1).toString()+"3").scrollIntoView(!0);break;case "B":document.getElementById("B"+
    (parseInt(f[0].substr(1))-1).toString()+"3").scrollIntoView(!0);break;case "C":document.getElementById("C"+(parseInt(f[0].substr(1))-1).toString()+"3").scrollIntoView(!0);break;case "D":document.getElementById("D"+(parseInt(f[0].substr(1))-1).toString()+"3").scrollIntoView(!0)}document.getElementById("Questionnaire").style.display="inline"}}compteur++}}else document.getElementById("Messages").innerHTML+="<br/>"+fileToLoad[b].name+" : fichier invalide !"}}
    function calculer(){for(var a=0,b=0,e=0,g=0,f=1;13>f;f++)for(var h=document.getElementsByName("A"+f),n=document.getElementsByName("B"+f),d=document.getElementsByName("C"+f),c=document.getElementsByName("D"+f),m=0;4>m;m++)h[m].checked&&(a+=parseInt(h[m].value)),n[m].checked&&(b+=parseInt(n[m].value)),d[m].checked&&(e+=parseInt(d[m].value)),c[m].checked&&(g+=parseInt(c[m].value));document.getElementById("exigences").value=a;document.getElementById("autonomie").value=b;document.getElementById("soutien").value=
    e;document.getElementById("reconnaissance").value=g}
    function collectif(){filesToLoad=document.getElementById("filesToLoadc").files;if(0<filesToLoad.length){document.getElementById("Messages").innerHTML+="<br/>Chargement de "+filesToLoad.length+" fichiers.";document.getElementById("Messages").style.display="inline";for(var a=compteur=0;a<filesToLoad.length;a++)if(0<filesToLoad[a].size&&"questionnaireQVT_"===filesToLoad[a].name.slice(0,17)&&".csv"===filesToLoad[a].name.slice(-4)){soutien=[];reconnaissance=[];exigences=[];autonomie=[];texteK=[];texteS=
    [];couleurK=[];couleurS=[];rouges=oranges=jaunes=verts=rougek=orangek=jaunek=vertk=0;var b=new FileReader;b.readAsText(filesToLoad[a],"UTF-8");b.onload=function(a){var b=a.target.result.split("\n");a=b[0].split(",");for(var f=b[1].split(","),e=b[2].split(","),n=b[3].split(","),d=[[0,1,2,3],[0,1,2,3],[3,2,1,0],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[3,2,1,0],[3,2,1,0],[0,1,2,3],[0,1,2,3]],c=[[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[3,2,1,0],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[3,2,1,
    0],[0,1,2,3],[3,2,1,0]],m=[[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3]],p=[[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[3,2,1,0],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3]],q=b=0,r=0,k=0,l=0;12>l;l++){switch(a[l]){case "pas d'accord":b+=d[l][0];break;case "plut\u00f4t pas d'accord":b+=d[l][1];break;case "plut\u00f4t d'accord":b+=d[l][2];break;case "d'accord":b+=d[l][3];break;default:document.getElementById("Messages").innerHTML+=
    "<br/>"+filesToLoad[compteur].name+" : incomplet";compteur++;return}switch(f[l]){case "pas d'accord":q+=c[l][0];break;case "plut\u00f4t pas d'accord":q+=c[l][1];break;case "plut\u00f4t d'accord":q+=c[l][2];break;case "d'accord":q+=c[l][3];break;default:document.getElementById("Messages").innerHTML+="<br/>"+filesToLoad[compteur].name+" : incomplet";compteur++;return}switch(e[l]){case "pas d'accord":r+=m[l][0];break;case "plut\u00f4t pas d'accord":r+=m[l][1];break;case "plut\u00f4t d'accord":r+=m[l][2];
    break;case "d'accord":r+=m[l][3];break;default:document.getElementById("Messages").innerHTML+="<br/>"+filesToLoad[compteur].name+" : incomplet";compteur++;return}switch(n[l]){case "pas d'accord":k+=p[l][0];break;case "plut\u00f4t pas d'accord":k+=p[l][1];break;case "plut\u00f4t d'accord":k+=p[l][2];break;case "d'accord":k+=p[l][3];break;default:document.getElementById("Messages").innerHTML+="<br/>"+filesToLoad[compteur].name+" : incomplet";compteur++;return}}soutien[compteur]=r;reconnaissance[compteur]=
    k;exigences[compteur]=b;autonomie[compteur]=q;a=positionpoint(r,b,q);f=positionpoint(k,b,q);switch(a){case 1:a="Le point est dans la zone de travail protecteur :)";couleurpointK="darkgreen";vertk++;break;case 2:a="Le point est dans la zone d'attention.";couleurpointK="yellow";jaunek++;break;case 3:a="Le point est dans la zone d'alerte !";couleurpointK="darkorange";orangek++;break;case 4:a="Le point est dans la zone de risque pour la sant\u00e9 :(";couleurpointK="red";rougek++;break;default:a="",couleurpointK=
    "darkgrey"}switch(f){case 1:f="Le point est dans la zone de travail protecteur :)";couleurpointS="darkgreen";verts++;break;case 2:f="Le point est dans la zone d'attention.";couleurpointS="yellow";jaunes++;break;case 3:f="Le point est dans la zone d'alerte !";couleurpointS="darkorange";oranges++;break;case 4:f="Le point est dans la zone de risque pour la sant\u00e9 :(";couleurpointS="red";rouges++;break;default:f="",couleurpointS="darkgrey"}a+="<br>"+filesToLoad[compteur].name;f+="<br>"+filesToLoad[compteur].name;
    texteK[compteur]=a;texteS[compteur]=f;couleurK[compteur]=couleurpointK;couleurS[compteur]=couleurpointS;if(compteur===filesToLoad.length-1){a=(exigences.reduce(function(a,b){return a+b})/exigences.length).toFixed(2);f=(autonomie.reduce(function(a,b){return a+b})/autonomie.length).toFixed(2);e=(soutien.reduce(function(a,b){return a+b})/soutien.length).toFixed(2);b=(reconnaissance.reduce(function(a,b){return a+b})/reconnaissance.length).toFixed(2);d=exigences.slice(0).sort(function(a,b){return a-b});
    c=Math.floor(d.length/2);q=0===d.length%2?((d[c]+d[c-1])/2).toFixed(2):d[c].toFixed(2);d=autonomie.slice(0).sort(function(a,b){return a-b});c=Math.floor(d.length/2);k=0===d.length%2?((d[c]+d[c-1])/2).toFixed(2):d[c].toFixed(2);d=exigences.slice(0).sort(function(a,b){return a-b});c=Math.floor(d.length/2);n=0===d.length%2?((d[c]+d[c-1])/2).toFixed(2):d[c].toFixed(2);d=exigences.slice(0).sort(function(a,b){return a-b});c=Math.floor(d.length/2);d=0===d.length%2?((d[c]+d[c-1])/2).toFixed(2):d[c].toFixed(2);
    document.getElementById("Recommandations").innerHTML="<p><h2><strong>Statistiques :</strong></h2></p><table class='tablestats'><thead><tr><th></th><th><h3>Exigences</h3></th><th><h3>Autonomie</h3></th><th><h3>Soutien</h3></th><th><h3>Reconnaissance</h3></th></tr></thead><tbody><tr><td><h3>Moyenne</h3></td><td>"+a+"</td><td>"+f+"</td><td>"+e+"</td><td>"+b+"</td></tr><tr><td><h3>M&eacute;diane</h3></td><td>"+q+"</td><td>"+k+"</td><td>"+n+"</td><td>"+d+"</td></tr></tr></tbody></table><p></p>";document.getElementById("Recommandations").innerHTML+=
    "<table class='tablestats'><thead><tr><th></th><th><h3>Zone verte</h3></th><th><h3>Zone jaune</h3></th><th><h3>Zone orange</h3></th><th><h3>Zone rouge</h3></th></tr></thead><tbody><tr><td><h3>Soutien</h3></td><td>"+vertk+"</td><td>"+jaunek+"</td><td>"+orangek+"</td><td>"+rougek+"</tr><tr><td><h3>Reconnaissance</h3></td><td>"+verts+"</td><td>"+jaunes+"</td><td>"+oranges+"</td><td>"+rouges+"</tr></tr></tbody></table><p></p><p><h2>Graphiques :</h2></p><p></p>";if(void 0===document.getElementById("karasek").data||
    void 0===document.getElementById("siegrist").data)document.getElementById("Messages").innerHTML+="<br/>Initialisation de l'environnement graphique...",prechargement();a={x:soutien,y:exigences,z:autonomie,type:"scatter3d",mode:"markers",hoverinfo:"x+y+z+text",hoverlabel:{bgcolor:couleurK},text:texteK,marker:{symbol:"diamond",size:4,opacity:.5}};f={x:reconnaissance,y:exigences,z:autonomie,type:"scatter3d",mode:"markers",hoverinfo:"x+y+z+text",hoverlabel:{bgcolor:couleurS},text:texteS,marker:{symbol:"diamond",
    size:4,opacity:.5}};e={showlegend:!1};b={showlegend:!0};Plotly.addTraces(document.getElementById("karasek"),a);Plotly.addTraces(document.getElementById("siegrist"),f);Plotly.restyle(document.getElementById("karasek"),e);Plotly.restyle(document.getElementById("karasek"),b,[0,1]);Plotly.restyle(document.getElementById("siegrist"),e);Plotly.restyle(document.getElementById("siegrist"),b,[0,1]);document.getElementById("cubes").style.display="grid";document.getElementById("Recommandations").style.display=
    "inline";document.getElementById("Recommandations").scrollIntoView(!0);changeclass("boutonQ",!0);changeclass("boutonG",!1)}compteur++}}else document.getElementById("Messages").innerHTML+="<br/>"+filesToLoad[a].name+" : fichier invalide !"}}
    function pleinecran(){document.getElementById("cubes").requestFullscreen();document.getElementById("cubes").addEventListener("fullscreenchange",function(a){document.fullscreenElement||(document.getElementById("cubes").style.width="100%",a=""+document.getElementById("cubes").offsetWidth/2+"px",document.getElementById("karasek").style.width=a,document.getElementById("karasek").style.height=a,document.getElementById("siegrist").style.width=a,document.getElementById("siegrist").style.height=a)})}
    function recommandations(a,b,e,g){var f=!1,h=!1,n=!1,d=!1,c="<p><h2><strong>Recommandations :</strong></h2></p><table id='tablerecos'><thead><tr><th id='texigences'><h3>Exigences</h3></th><th id='tautonomie'><h3>Autonomie</h3></th><th id='tsoutien'><h3>Soutien</h3></th><th id='treconnaissance'><h3>Reconnaissance</h3></th></tr></thead><tbody><tr>";9<e&&19>e&&18<g&&28>g&&18<a&&28>a&&(n=h=f=!0);9<e&&19>e&&18<g&&28>g&&18<b&&28>b&&(d=h=f=!0);18<e&&(f=!0);19>g&&(h=!0);19>a&&(n=!0);19>b&&(d=!0);c=!0===f?
    c+'<td><ul><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/organisation-du-travail-son-environnement-et-ses-espaces/teletravail-co-working-nomadisme-mobilite/" target="_fiche">T&eacute;l&eacute;travail, CoWorking, Nomadisme, Mobilit&eacute;</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/organisation-du-travail-son-environnement-et-ses-espaces/charge-de-travail-et-intensification-du-travail/" target="_fiche">Charge de travail et intensification du travail</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/temps-de-travail-et-deconnexion/forfait-jours-et-sante-au-travail/" target="_fiche">Forfait jours et sant&eacute; au travail</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/management-et-formation/accompagnement-et-formation-a-lutilisation-des-outils-numeriques/" target="_fiche">Accompagnement et formation \u00e0 l\'utilisation des outils num&eacute;riques</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/temps-de-travail-et-deconnexion/disponibilite-et-deconnexion/" target="_fiche">Disponibilit&eacute; et d&eacute;connexion</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/organisation-du-travail-son-environnement-et-ses-espaces/reconfiguration-et-instabilite-des-organisations-de-travail/" target="_fiche">Reconfiguration et instabilit&eacute; des organisations de travail</a></li></ul></td>':
    10>e&&27<g?c+"<td><p><strong>Note : &ecirc;tre attentif au bore-out lorsque les exigences sont faibles et l'autonomie &eacute;lev&eacute;e.</strong></p></td>":c+"<td></td>";c=!0===h?c+'<td><ul><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/management-et-formation/tracabilite-autonomie-et-reconnaissance/" target="_fiche">Tra&ccedil;abilit&eacute;, autonomie et reconnaissance</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/temps-de-travail-et-deconnexion/equilibre-vie-professionnelle-vie-personnelle/" target="_fiche">Equilibre vie professionnelle, vie personnelle</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/temps-de-travail-et-deconnexion/outils-numeriques-et-temps-de-travail-masque/" target="_fiche">Outils num&eacute;riques et temps de travail masqu&eacute;</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/temps-de-travail-et-deconnexion/forfait-jours-et-sante-au-travail/" target="_fiche">Forfait jours et sant&eacute; au travail</a></li><li><a href="https://lenumeriqueautrement.fr/blog/quelle-est-la-realite-du-temps-de-travail-des-cadres/" target="_fiche">R&eacute;alit&eacute; du temps de travail des cadres</a></li><li><a href="https://lenumeriqueautrement.fr/les-outils/le-guide-du-droit-a-la-deconnexion/" target="_fiche">Guide du droit \u00e0 la d&eacute;connexion</a></li><li><a href="https://qvtnumerique.azureedge.net/GuideManagement-Fiche2-UGICT-CGT.pdf" target="_fiche">Fiche 2 du Guide du Management &agrave; l\'&egrave;re du num&eacute;rique</a></li></ul></td>':
    c+"<td></td>";c=!0===n?c+'<td><ul><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/management-et-formation/management-et-soutien/" target="_fiche">Management et soutien</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/droit-dexpression/droit-dexpression-latitude-decisionnelle-et-conduite-du-changement/" target="_fiche">Droit d\'expression, latitude d&eacute;cisionnelle et conduite du changement</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/management-et-formation/accompagnement-et-formation-a-lutilisation-des-outils-numeriques/" target="_fiche">Accompagnement et formation &agrave; l\'utilisation des outils num&eacute;riques</a></li><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/organisation-du-travail-son-environnement-et-ses-espaces/securite-des-donnees-et-des-utilisateurs/" target="_fiche">S&eacute;curit&eacute; des donn&eacute;es et des utilisateurs</a></li><li><a href="https://qvtnumerique.azureedge.net/GuideManagement-Fiche1-UGICT-CGT.pdf" target="_fiche">Fiche 1 du Guide du Management &agrave; l\'&egrave;re du num&eacute;rique</a></li><li><a href="https://qvtnumerique.azureedge.net/GuideManagement-Fiche3-UGICT-CGT.pdf" target="_fiche">Fiche 3 du Guide du Management &agrave; l\'&egrave;re du num&eacute;rique</a></li></ul></td>':
    c+"<td></td>";c=!0===d?c+'<td><ul><li><a href="https://lenumeriqueautrement.fr/fiches-qvt/management-et-formation/tracabilite-autonomie-et-reconnaissance/" target="_fiche">Tra&ccedil;abilit&eacute;, autonomie et reconnaissance</a></li><li><a href="https://qvtnumerique.azureedge.net/GuideManagement-Fiche4-UGICT-CGT.pdf" target="_fiche">Fiche 4 du Guide du Management &agrave; l\'&egrave;re du num&eacute;rique</a></li><li><a href="https://qvtnumerique.azureedge.net/GuideManagement-Fiche5-UGICT-CGT.pdf" target="_fiche">Fiche 5 du Guide du Management &agrave; l\'&egrave;re du num&eacute;rique</a></li></ul></td>':
    c+"<td></td>";document.getElementById("Recommandations").innerHTML=c+"</tr></tbody></table><p></p><p><h2>Graphiques :</h2></p><p></p>";10>e?document.getElementById("texigences").style.backgroundColor="green":19>e?document.getElementById("texigences").style.backgroundColor="yellow":28>e?document.getElementById("texigences").style.backgroundColor="orange":document.getElementById("texigences").style.backgroundColor="red";10>g?document.getElementById("tautonomie").style.backgroundColor="red":19>g?document.getElementById("tautonomie").style.backgroundColor=
    "orange":28>g?document.getElementById("tautonomie").style.backgroundColor="yellow":document.getElementById("tautonomie").style.backgroundColor="green";10>a?document.getElementById("tsoutien").style.backgroundColor="red":19>a?document.getElementById("tsoutien").style.backgroundColor="orange":28>a?document.getElementById("tsoutien").style.backgroundColor="yellow":document.getElementById("tsoutien").style.backgroundColor="green";10>b?document.getElementById("treconnaissance").style.backgroundColor="red":
    19>b?document.getElementById("treconnaissance").style.backgroundColor="orange":28>b?document.getElementById("treconnaissance").style.backgroundColor="yellow":document.getElementById("treconnaissance").style.backgroundColor="green";document.getElementById("Questionnaire").style.display="inline";document.getElementById("Recommandations").style.display="inline";changeclass("boutonQ",!0);changeclass("boutonG",!1);document.getElementById("Recommandations").scrollIntoView(!0)}
    function menu(a){switch(a){case "apropos":document.getElementById("Apropos").style.display="inline";document.getElementById("Aide").style.display="none";document.getElementById("Questionnaire").style.display="none";document.getElementById("AnalyseI").style.display="none";document.getElementById("AnalyseG").style.display="none";document.getElementById("AnalyseC").style.display="none";document.getElementById("cubes").style.display="none";document.getElementById("Messages").style.display="none";document.getElementById("Recommandations").style.display=
    "none";changeclass("boutonQ",!0);break;case "aide":document.getElementById("Apropos").style.display="none";document.getElementById("Aide").style.display="inline";document.getElementById("Questionnaire").style.display="none";document.getElementById("AnalyseI").style.display="none";document.getElementById("AnalyseG").style.display="none";document.getElementById("AnalyseC").style.display="none";document.getElementById("cubes").style.display="none";document.getElementById("Messages").style.display="none";
    document.getElementById("Recommandations").style.display="none";changeclass("boutonQ",!0);break;case "questionnaire":effacer();document.getElementById("Apropos").style.display="none";document.getElementById("Aide").style.display="none";document.getElementById("Questionnaire").style.display="inline";document.getElementById("AnalyseI").style.display="none";document.getElementById("AnalyseG").style.display="none";document.getElementById("AnalyseC").style.display="none";document.getElementById("cubes").style.display=
    "none";document.getElementById("Messages").style.display="none";document.getElementById("Recommandations").style.display="none";changeclass("boutonQ",!1);break;case "individu":document.getElementById("fileToLoad").value="";document.getElementById("Apropos").style.display="none";document.getElementById("Aide").style.display="none";document.getElementById("Questionnaire").style.display="none";document.getElementById("AnalyseI").style.display="inline";document.getElementById("AnalyseG").style.display=
    "none";document.getElementById("AnalyseC").style.display="none";document.getElementById("cubes").style.display="none";document.getElementById("Messages").style.display="none";document.getElementById("Recommandations").style.display="none";changeclass("boutonQ",!0);break;case "groupe":document.getElementById("filesToLoad").value="";document.getElementById("Apropos").style.display="none";document.getElementById("Aide").style.display="none";document.getElementById("Questionnaire").style.display="none";
    document.getElementById("AnalyseI").style.display="none";document.getElementById("AnalyseG").style.display="inline";document.getElementById("AnalyseC").style.display="none";document.getElementById("cubes").style.display="none";document.getElementById("Messages").style.display="none";document.getElementById("Recommandations").style.display="none";changeclass("boutonQ",!0);break;case "collectif":document.getElementById("filesToLoadc").value="";document.getElementById("Apropos").style.display="none";
    document.getElementById("Aide").style.display="none";document.getElementById("Questionnaire").style.display="none";document.getElementById("AnalyseI").style.display="none";document.getElementById("AnalyseG").style.display="none";document.getElementById("AnalyseC").style.display="inline";document.getElementById("cubes").style.display="none";document.getElementById("Messages").style.display="none";document.getElementById("Recommandations").style.display="none";changeclass("boutonQ",!0);break;case "graphiques":"none"===
    document.getElementById("cubes").style.display&&(document.getElementById("Apropos").style.display="none",document.getElementById("Aide").style.display="none",document.getElementById("Questionnaire").style.display="none",document.getElementById("AnalyseI").style.display="none",document.getElementById("AnalyseG").style.display="none",document.getElementById("AnalyseC").style.display="none",document.getElementById("cubes").style.display="grid",document.getElementById("Messages").style.display="none",
    document.getElementById("Recommandations").style.display="none",changeclass("boutonQ",!0));break;default:document.getElementById("fileToLoad").value="",document.getElementById("filesToLoad").value="",document.getElementById("filesToLoadc").value="",document.getElementById("Apropos").style.display="inline",document.getElementById("Aide").style.display="none",document.getElementById("Questionnaire").style.display="none",document.getElementById("AnalyseI").style.display="none",document.getElementById("AnalyseG").style.display=
    "none",document.getElementById("AnalyseC").style.display="none",document.getElementById("cubes").style.display="none",document.getElementById("Messages").style.display="none",document.getElementById("Recommandations").style.display="none",changeclass("boutonQ",!0),changeclass("boutonG",!0)}}function changeclass(a,b){elements=document.getElementsByClassName(a);for(var e=0;e<elements.length;e++)elements[e].disabled=b};